##############################QUERIES RELATED TO MOBILE SERVICES#########################################
checklistHierarchy1=select distinct cfd.base_form_id, cfd.bfd_form_id, cfd.bfd_name, cfd.created_date, (select form_status from ckschema.checklist_form_status_master where form_status_id = cfd.bfd_status_id) bfd_status, cfd.publish_version form_version,(select langmas.bfrm_language_name from ckschema.checklist_language_master langmas, ckschema.checklist_language_map langmap where langmas.bfrm_language_id = langmap.bfrm_language_id and langmap.bfd_form_id = cfd.bfd_form_id) form_language, cga.group_id from ckschema.checklist_form_details cfd, ckschema.checklist_group_association cga where cfd.bfd_form_id = cga.bfd_form_id and cfd.bfd_status_id = ? and cga.group_id in (
checklistHierarchy2=) and cfd.publish_version = (SELECT max(fd.publish_version) from ckschema.checklist_form_details fd where fd.base_form_id = cfd.base_form_id) order by cfd.bfd_form_id asc
userroleandpermission=select chkm.bi_user_sso, chkm.bi_user_lname, chkm.bi_user_fname,chkr.role_name, bi_group_id, chkm.ischecklistappuser from ckschema.checklist_user_master chkm, ckschema.checklist_role_master chkr, ckschema.checklist_user_role_map chkmap, ckschema.checklist_user_group_association ugmap  where chkm.bi_user_sso = ? and chkm.bi_user_id = chkmap.user_id and chkmap.role_id = chkr.bi_role_id and chkm.bi_user_id = ugmap.user_id;
#checklistBusinessHierarchy=WITH RECURSIVE tree (bi_group_id,bi_bus_group_name,bi_bus_group_parent_id) AS ( SELECT bi_group_id, bi_bus_group_name, bi_bus_group_parent_id FROM ckschema.checklist_bus_group_master WHERE bi_bus_group_parent_id = 0 UNION ALL SELECT c.bi_group_id, c.bi_bus_group_name, c.bi_bus_group_parent_id FROM tree JOIN ckschema.checklist_bus_group_master c ON (tree.bi_group_id =  c.bi_bus_group_parent_id) ) SELECT bi_group_id,bi_bus_group_name,bi_bus_group_parent_id FROM tree order by bi_bus_group_parent_id, bi_group_id asc;
checklistBusinessHierarchy1=WITH RECURSIVE business_hierarchy(bi_group_id,bi_bus_group_name,bi_bus_group_parent_id) AS (SELECT bi_group_id,bi_bus_group_name,bi_bus_group_parent_id FROM ckschema.checklist_bus_group_master WHERE bi_group_id in (
checklistBusinessHierarchy2=) UNION ALL SELECT gm.bi_group_id, gm.bi_bus_group_name, gm.bi_bus_group_parent_id FROM ckschema.checklist_bus_group_master gm, business_hierarchy hr  WHERE hr.bi_bus_group_parent_id = gm.bi_group_id) SELECT distinct bi_group_id,bi_bus_group_name,bi_bus_group_parent_id FROM business_hierarchy order by bi_group_id;
getChecklistMetadata=SELECT sec.bfs_section_id, sec.bfs_section_label,bfs_section_name, (SELECT array_agg(helptext_details.*) FROM (select concat(imgDetails.help_img_id::text, '#'), concat(helpdetail.help_desc::text, '#'), concat(imgDetails.help_img_url::text, '#') from ckschema.checklist_help_text_details_1 helpdetail,ckschema.checklist_help_image_details imgDetails where helpdetail.association_id  = sec.bfs_section_id and helpdetail.help_text_level = 'Section' and imgDetails.association_id  = sec.bfs_section_id and imgDetails.help_text_level = 'Section') helptext_details) section_helptext, (SELECT array_agg(sq.*) FROM (SELECT step.bfs_step_id,bfs_step_name, step.bfs_step_label, (SELECT array_agg(help_image.*) FROM (SELECT concat(imgDetails.help_img_id::text, '#')|| concat(helpdetail.help_desc::text, '#')|| imgDetails.help_img_url stephelpdetail from ckschema.checklist_help_text_details_1 helpdetail,ckschema.checklist_help_image_details imgDetails where helpdetail.association_id = step.bfs_step_id and helpdetail.help_text_level = 'Step' and imgDetails.association_id  = step.bfs_step_id and imgDetails.help_text_level = 'Step')help_image) stephelpdetail FROM ckschema.checklist_steps_details step WHERE step.bfs_section_id = sec.bfs_section_id order by step.bfs_step_id) sq) step_detail FROM ckschema.checklist_section_details sec WHERE sec.bfs_form_lang_id in (select bfd_lang_id from ckschema.checklist_language_map lanmap, ckschema.checklist_form_details form where lanmap.bfd_form_id = form.bfd_form_id and form.bfd_form_id = ? and lanmap.bfrm_language_id = (select bfrm_language_id from ckschema.checklist_language_master where bfrm_language_name = ?) and form.base_form_id = ? and form.publish_version = ?) ORDER BY sec.section_order asc;
#getChecklistMetadata=SELECT sec.bfs_section_id, sec.bfs_section_label,bfs_section_name, (SELECT array_agg(helptext_details.*) FROM (select helpdetail.help_text_id||'#', helpdetail.helptext_desc||'#', helpdetail.image_url::text||'#' from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = sec.bfs_section_id and helpdetail.help_text_level = 'Section') helptext_details) section_helptext, (SELECT array_agg(sq.*) FROM (SELECT step.bfs_step_id,bfs_step_name, step.bfs_step_label, (SELECT helpdetail.help_text_id||'#'|| helpdetail.helptext_desc||'#'|| helpdetail.image_url stephelpdetail from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id = step.bfs_step_id and help_text_level = 'Step') stephelpdetail FROM ckschema.checklist_steps_details step WHERE step.bfs_section_id = sec.bfs_section_id) sq) step_detail FROM ckschema.checklist_section_details sec WHERE sec.bfs_form_lang_id in (select bfd_lang_id from ckschema.checklist_language_map lanmap, ckschema.checklist_form_details form where lanmap.bfd_form_id = form.base_form_id and form.bfd_form_id = ? and lanmap.bfrm_language_id = (select bfrm_language_id from ckschema.checklist_language_master where bfrm_language_name = ?) and form.base_form_id = ? and form.publish_version = ?) ORDER BY sec.section_order asc;
getChecklistFormNamefromId=select form.bfd_form_id, form.bfd_name, form.project_applicability, (SELECT array_agg(helptext_details.*) FROM (select concat(imgDetails.help_img_id::text, '#'), concat(helpdetail.help_desc::text, '#'), concat(imgDetails.help_img_url::text, '#') from ckschema.checklist_help_text_details_1 helpdetail,ckschema.checklist_help_image_details imgDetails where helpdetail.association_id  = form.bfd_form_id and helpdetail.help_text_level = 'Form' and imgDetails.association_id  = form.bfd_form_id and imgDetails.help_text_level = 'Form') helptext_details) form_helptext, (select count(sec.bfs_section_id) from ckschema.checklist_section_details sec, ckschema.checklist_language_map lanmap where sec.bfs_form_lang_id = lanmap.bfd_lang_id and lanmap.bfd_form_id = form.bfd_form_id) section_count, form.publish_version  from ckschema.checklist_form_details form, ckschema.checklist_language_map lanmap where form.bfd_form_id = ? and lanmap.bfd_form_id = form.base_form_id and lanmap.bfrm_language_id = (select bfrm_language_id from ckschema.checklist_language_master where bfrm_language_name = ?) and form.base_form_id = ? and form.publish_version = ?
#getChecklistFormNamefromId=select form.bfd_form_id, form.bfd_name, form.project_applicability, (SELECT array_agg(helptext_details.*) FROM (select helpdetail.help_text_id||'#', helpdetail.helptext_desc||'#', helpdetail.image_url::text||'#' from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = form.bfd_form_id and helpdetail.help_text_level = 'Form') helptext_details) form_helptext, (select count(sec.bfs_section_id) from ckschema.checklist_section_details sec, ckschema.checklist_language_map lanmap where sec.bfs_form_lang_id = lanmap.bfd_lang_id and lanmap.bfd_form_id = form.bfd_form_id) section_count  from ckschema.checklist_form_details form, ckschema.checklist_language_map lanmap where form.bfd_form_id = ? and lanmap.bfd_form_id = form.base_form_id and lanmap.bfrm_language_id = (select bfrm_language_id from ckschema.checklist_language_master where bfrm_language_name = ?) and form.base_form_id = ? and form.publish_version = ?
#getStepDetailFromStepid=SELECT ques.bfs_step_id, ques.bfs_ques_id, ques.question_order, ques.ques_accessibility, ques.ques_desc, ans.bfs_ans_id, ans.ans_desc, (SELECT array_agg(questab.*) FROM (select quenele.element_order, bftm_element_name from ckschema.checklist_element_master master, ckschema.checklist_question_ele_map quenele where master.bftm_element_id = quenele.bftm_element_id and ques.bfs_ques_id = quenele.bfs_ques_id) questab) question_element, (SELECT array_agg(questab.*) FROM (select ansele.bftm_element_id, ansele.element_order, bftm_element_name from ckschema.checklist_element_master master, ckschema.checklist_ans_ele_map ansele where master.bftm_element_id = ansele.bftm_element_id AND ans.bfs_ans_id =  ansele.bfs_ans_id) questab) answer_element, (select tag.tag_name from ckschema.checklist_tag_master tag, ckschema.checklist_tag_mapping tagmap where tag.tag_master_id = tagmap.tag_master_id and tagmap.qa_assoc_id = mapp.bfs_qa_assoc_id) element_tag, (select array_agg(element_attribute.*) FROM (select distinct eamap.bfs_element_id, eamap.bftm_attrib_id, (select bftm_attrib_name from ckschema.checklist_elem_attrib_master where bftm_attrib_id = eamap.bftm_attrib_id)bftm_attrib_name, bftm_attrib_value, aemap.element_order from ckschema.checklist_elem_attrib_mapping eamap, ckschema.checklist_ans_ele_map aemap where eamap.qa_assoc_id = aemap.bfs_ans_ele_map_id and aemap.bfs_ans_id = mapp.bfs_ans_id) element_attribute) element_attribute, (SELECT array_agg(ans_rule.*) FROM (select erm.bfrm_rule_id,erm.bfrm_rule_name,arm.rule_formula_data, ram.rule_action_tag,aram.rule_action_output, aram.no_fields_to_add from ckschema.checklist_elem_rule_master erm,ckschema.checklist_rule_action_master ram,ckschema.checklist_ans_rule_mapping arm, ckschema.checklist_ans_rule_action_mapping aram where arm.bfs_rule_id=erm.bfrm_rule_id and aram.ans_rule_map_id=arm.bfs_ans_rule_id and ram.rule_action_id=aram.rule_action_id and arm.bfs_ans_id = mapp.bfs_qa_assoc_id) ans_rule) validation_rule, (SELECT array_agg(helptext_details.*) FROM (select concat(helpdetail.help_text_id::text, '#'), concat(helpdetail.helptext_desc::text, '#'), concat(helpdetail.image_url::text, '#') from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = ques.bfs_ques_id and help_text_level = 'Question') helptext_details) helptext_details from ckschema.checklist_question_details ques, ckschema.checklist_answer_details ans, ckschema.checklist_ques_ans_mapping mapp where  mapp.bfs_ques_id = ques.bfs_ques_id AND mapp.bfs_ans_id =  ans.bfs_ans_id and ques.bfs_step_id  = ? order by ques.question_order asc
getStepDetailFromStepid=select ques.bfs_step_id, ques.bfs_ques_id, ques.question_order, ques.ques_accessibility, ques.ques_desc, ans.bfs_ans_id, ans.ans_desc, (SELECT array_agg(questab.*) FROM (select quenele.element_order, bftm_element_name from ckschema.checklist_element_master master, ckschema.checklist_question_ele_map quenele where master.bftm_element_id = quenele.bftm_element_id and ques.bfs_ques_id = quenele.bfs_ques_id) questab) question_element, (SELECT array_agg(questab.*) FROM (select ansele.bftm_element_id, ansele.element_order, bftm_element_name from  ckschema.checklist_element_master master, ckschema.checklist_ans_ele_map ansele where master.bftm_element_id = ansele.bftm_element_id AND ans.bfs_ans_id =  ansele.bfs_ans_id order by ansele.element_order asc) questab) answer_element, (select tag.tag_name from ckschema.checklist_tag_master tag, ckschema.checklist_tag_mapping tagmap where tag.tag_master_id = tagmap.tag_master_id and tagmap.qa_assoc_id = mapp.bfs_qa_assoc_id) element_tag,(select array_agg(element_attribute.*) FROM (select distinct eamap.bfs_element_id, eamap.bftm_attrib_id, (select bftm_attrib_name from ckschema.checklist_elem_attrib_master where bftm_attrib_id = eamap.bftm_attrib_id)bftm_attrib_name, bftm_attrib_value, aemap.element_order from ckschema.checklist_elem_attrib_mapping eamap, ckschema.checklist_ans_ele_map aemap where eamap.qa_assoc_id = aemap.bfs_ans_ele_map_id and eamap.bfs_element_id = aemap.bftm_element_id and aemap.bfs_ans_id = ans.bfs_ans_id) element_attribute) element_attribute, (SELECT array_agg(ans_rule.*) FROM (select distinct erm.bfrm_rule_id, erm.bfrm_rule_name, arm.rule_formula_data, ram.rule_action_tag, aram.rule_action_output, aram.no_fields_to_add, aem.bftm_element_id, aem.element_order from ckschema.checklist_elem_rule_master erm, ckschema.checklist_rule_action_master ram, ckschema.checklist_ans_rule_mapping arm, ckschema.checklist_ans_rule_action_mapping aram, ckschema.checklist_ans_ele_map aem  where arm.bfs_rule_id=erm.bfrm_rule_id and aram.ans_rule_map_id=arm.bfs_ans_rule_id and ram.rule_action_id=aram.rule_action_id and erm.bftm_element_id = aem.bftm_element_id  and erm.bfrm_rule_category = 'Data Centric' and arm.bfs_ans_id = mapp.bfs_qa_assoc_id and aem.bfs_ans_id = ans.bfs_ans_id) ans_rule) validation_rule, (SELECT array_agg(helptext_details.*) FROM (select imgDetails.help_img_id||'#', helpdetail.help_desc||'#', imgDetails.help_img_url||'#' from ckschema.checklist_help_text_details_1 helpdetail,ckschema.checklist_help_image_details imgDetails where helpdetail.association_id  = ques.bfs_ques_id and helpdetail.help_text_level = 'Question' and imgDetails.association_id  = ques.bfs_ques_id and imgDetails.help_text_level = 'Question') helptext_details) helptext_details from ckschema.checklist_question_details ques, ckschema.checklist_answer_details ans, ckschema.checklist_ques_ans_mapping mapp where  mapp.bfs_ques_id = ques.bfs_ques_id AND mapp.bfs_ans_id =  ans.bfs_ans_id and ques.bfs_step_id = ? order by ques.question_order asc
getStepDetailFromStepid_1=select ques.bfs_step_id, ques.bfs_ques_id, ques.question_order, ques.ques_accessibility, ques.ques_desc, ans.bfs_ans_id, ans.ans_desc, mapp.bfs_ans_id, (SELECT array_agg(questab.*) FROM (select quenele.element_order, bftm_element_name from ckschema.checklist_element_master master, ckschema.checklist_question_ele_map quenele where master.bftm_element_id = quenele.bftm_element_id and ques.bfs_ques_id = quenele.bfs_ques_id) questab) question_element, (SELECT array_agg(questab.*) FROM (select ansele.bftm_element_id, ansele.element_order, bftm_element_name from  ckschema.checklist_element_master master, ckschema.checklist_ans_ele_map ansele where master.bftm_element_id = ansele.bftm_element_id AND ans.bfs_ans_id =  ansele.bfs_ans_id order by ansele.element_order asc) questab) answer_element, (select tag.tag_name from ckschema.checklist_tag_master tag, ckschema.checklist_tag_mapping tagmap where tag.tag_master_id = tagmap.tag_master_id and tagmap.qa_assoc_id = mapp.bfs_qa_assoc_id) element_tag,(select array_agg(element_attribute.*) FROM (select distinct eamap.bfs_element_id, eamap.bftm_attrib_id, (select bftm_attrib_name from ckschema.checklist_elem_attrib_master where bftm_attrib_id = eamap.bftm_attrib_id)bftm_attrib_name, bftm_attrib_value, aemap.element_order from ckschema.checklist_elem_attrib_mapping eamap, ckschema.checklist_ans_ele_map aemap where eamap.qa_assoc_id = aemap.bfs_ans_ele_map_id and eamap.bfs_element_id = aemap.bftm_element_id and aemap.bfs_ans_id = ans.bfs_ans_id) element_attribute) element_attribute, (SELECT array_agg(ans_rule.*) FROM (select distinct erm.bfrm_rule_id, erm.bfrm_rule_name, arm.rule_formula_data, aem.bftm_element_id, aem.element_order,erm.rule_formula,erm.bftm_element_id, (SELECT array_agg(rule_action.*) FROM (select aram.rule_action_id,ram.rule_action__desc,ram.rule_action_tag, aram.rule_action_output, aram.rule_action_output_value,aram.no_fields_to_add from ckschema.checklist_rule_action_master ram,ckschema.checklist_ans_rule_action_mapping aram where aram.ans_rule_map_id=arm.bfs_ans_rule_id and ram.rule_action_id=aram.rule_action_id) rule_action) rule_action_detail from ckschema.checklist_elem_rule_master erm, ckschema.checklist_ans_rule_mapping arm, ckschema.checklist_ans_ele_map aem  where arm.bfs_rule_id=erm.bfrm_rule_id and erm.bftm_element_id = aem.bftm_element_id  and erm.bfrm_rule_category = 'Data Centric' and arm.bfs_ans_id = mapp.bfs_qa_assoc_id and aem.bfs_ans_id = ans.bfs_ans_id) ans_rule) validation_rule, (SELECT array_agg(helptext_details.*) FROM (select helpdetail.help_text_id||'#', helpdetail.helptext_desc||'#', helpdetail.image_url||'#' from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = ques.bfs_ques_id and help_text_level = 'QuestionHelp') helptext_details) helptext_details from ckschema.checklist_question_details ques, ckschema.checklist_answer_details ans, ckschema.checklist_ques_ans_mapping mapp where  mapp.bfs_ques_id = ques.bfs_ques_id AND mapp.bfs_ans_id =  ans.bfs_ans_id and ques.bfs_step_id = ? order by ques.question_order asc;
#getSectionStepofLast10Records=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where cast( bi_user_sso as int8) = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where cast(bi_user_sso  as int8) = entry.updated_by) modifiedby_name, entry.updated_by, entry.created_by, entry.updated_date, entry.created_date from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ? and bfrm_language_name = ?) order by entry.updated_date desc, entry.record_id desc limit 10
getSectionStepofLast10Records=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name, entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no,(select bfd_form_id from ckschema.checklist_form_details where base_form_id = ? and publish_version = entry.record_version_no) form_id from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id in (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id in (select bfd_form_id from ckschema.checklist_form_details where base_form_id = ?) and bfrm_language_name = ?) and entry.project_id = ? order by entry.updated_date desc, entry.record_id desc limit ? offset ?
#getRecordDetailbyRecordIdStepId=select quedetail.bfs_ques_id, mapp.bfs_ans_id, detail.ans_desc, detail.comments, (SELECT array_agg(imagetab.*) FROM (select form_img_id, image_location, image_desc from ckschema.checklist_record_image_data where bfs_qa_assoc_id = detail.bfs_qa_assoc_id) imagetab) image_array from ckschema.checklist_record_section_step_details detail, ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where detail.record_id = ? and quedetail.bfs_step_id = detail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and detail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id and quedetail.bfs_step_id = ? order by quedetail.bfs_ques_id
getRecordDetailbyRecordIdStepId=select detail.section_id, detail.step_id, quedetail.bfs_ques_id, mapp.bfs_ans_id, detail.ans_desc, detail.comments, detail.element_id, detail.sequesnce_no, (select bftm_element_name from ckschema.checklist_element_master where bftm_element_id = detail.element_id)element_name, (select eamap.bftm_attrib_value from ckschema.checklist_elem_attrib_mapping eamap where eamap.bftm_attrib_id = (select bftm_attrib_id from ckschema.checklist_elem_attrib_master where (bftm_attrib_name = 'name' or bftm_attrib_name = 'Name') and bftm_element_id = detail.element_id) and eamap.qa_assoc_id = (select bfs_ans_ele_map_id from ckschema.checklist_ans_ele_map aemap where aemap.bfs_ans_id = mapp.bfs_ans_id and aemap.bftm_element_id = detail.element_id and aemap.element_order = detail.sequesnce_no)) name_attrib_value,(SELECT array_agg(imagetab.*) FROM (select form_img_id, image_location, image_desc, image_thumbnail_data from ckschema.checklist_record_image_data where bfs_qa_assoc_id = quedetail.bfs_ques_id and record_id = detail.record_id and image_type = 'RecordImage') imagetab) image_array, (SELECT array_agg(imagetab.*) FROM (select form_img_id, image_location, image_desc, image_thumbnail_data from ckschema.checklist_record_image_data where bfs_qa_assoc_id = quedetail.bfs_ques_id and record_id = detail.record_id and image_type = 'RuleImage' and element_id = detail.element_id and sequesnce_no = detail.sequesnce_no) imagetab) ruleimage_array,(SELECT array_agg(additional_fields.*) FROM (select ans_key, ans_desc from ckschema.checklist_record_rules_answres where bfs_qa_assoc_id = mapp.bfs_qa_assoc_id and record_id = detail.record_id) additional_fields) additional_fields from ckschema.checklist_record_section_step_details detail, ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where detail.record_id = ? and quedetail.bfs_step_id = detail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and detail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id order by detail.section_id, detail.step_id, quedetail.bfs_ques_id
getRuleCategory=select distinct bfrm_rule_category from ckschema.checklist_elem_rule_master order by bfrm_rule_category asc
getElementrules=select bfrm_rule_id, bfrm_rule_name, bfrm_rule_description, rule_formula, bfrm_rule_category from ckschema.checklist_elem_rule_master order by bfrm_rule_id asc
getRuleActionDetail=select rule_action_id, rule_action_tag, rule_action__desc from ckschema.checklist_rule_action_master order by rule_action_id asc
insertrecordentry=INSERT INTO ckschema.checklist_record_form_entry(record_id,bfs_form_lang_id,form_status_id,created_by,created_date,updated_by,updated_date,syncstatus,project_id, turbine_id,record_version_no) values(?::integer,?::integer,(select form_status_id from ckschema.checklist_form_status_master where upper(form_status) = upper(?)),?::integer,?::timestamp,?::integer,?::timestamp,?,?,?,?);
insertrecord=INSERT INTO ckschema.checklist_record_section_step_details(record_id,section_id,step_id,bfs_qa_assoc_id,comments,created_by,createddatetime,modifieddatetime, is_deleted, ans_desc, element_id, sequesnce_no) values(?::integer,?::integer,?::integer,?::integer,?,?::integer,?::timestamp,?::timestamp,?,?,?::integer,?::integer);
insertruleansvalue=INSERT INTO ckschema.checklist_record_rules_answres(bfs_qa_assoc_id,ans_key,ans_desc,record_id)values(?::integer,?,?,?::integer);
recordnumber=select nextval('ckschema.checklist_record_seq'::regclass)::regclass;
languageid=select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?::integer and bfrm_language_id =(Select bfrm_language_id from ckschema.checklist_language_master where upper(bfrm_language_name) = upper(?))
recordstatus=UPDATE ckschema.checklist_record_form_entry SET syncstatus = 'Synced' where record_id = ?::integer
#insertrecord=INSERT INTO ckschema.checklist_record_section_step_details(record_id,section_id,step_id,bfs_qa_assoc_id,comments,created_by,createddatetime,modifieddatetime, syncstatus, is_deleted, ans_desc) values((select currval('checklist_record_seq')),?::integer,?::integer,(select bfs_qa_assoc_id from ckschema.checklist_ques_ans_mapping where bfs_ques_id = ?::integer),?,?::integer,?::timestamp,?::timestamp,?,?,?);
updaterecordentry=UPDATE ckschema.checklist_record_form_entry SET bfs_form_lang_id = ?::integer,form_status_id = (select form_status_id from ckschema.checklist_form_status_master where upper(form_status) = upper(?)), updated_by = ?::integer, updated_date = ?::timestamp,syncstatus = ?,record_version_no=? where record_id = ?::integer;
updaterecord=UPDATE ckschema.checklist_record_section_step_details SET section_id = ?::integer,step_id = ?::integer,bfs_qa_assoc_id = ?::integer,comments = ?, modifiedby = ?::integer, modifieddatetime = now(), is_deleted = ?, ans_desc = ?, element_id = ?, sequesnce_no = ? where record_id = ?::integer and bfs_qa_assoc_id = (select bfs_qa_assoc_id from ckschema.checklist_ques_ans_mapping where bfs_ques_id = ?::integer) and sequesnce_no = ?::integer;
updateruleansvalue=UPDATE ckschema.checklist_record_rules_answres SET ans_key = ?,ans_desc = ? where record_id = ?::integer and bfs_qa_assoc_id = ?::integer);
deleteruleansvalue=delete from ckschema.checklist_record_rules_answres where record_id = ?::integer and bfs_qa_assoc_id = ?::integer;
getChecklistImageDetail=select hdetail.image_url from ckschema.checklist_help_text_details hdetail, ckschema.checklist_question_details qamap where hdetail.association_id = qamap.bfs_ques_id and qamap.bfs_ques_id = ? and hdetail.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?)
#getEDSRProjectTurbineDetail=SELECT distinct project_id, sys_project_id, project_name from ckschema.checklist_edsr_proj_turb_details WHERE visible = 'Yes' order by project_name
getEDSRProjectTurbineDetail=select distinct project_id, project_name, turbine_id from ckschema.checklist_edsr_proj_turb_details order by project_name, turbine_id 
getEDSRTurbineDetailByProjectId=select turbine_id from ckschema.checklist_edsr_proj_turb_details where project_id = ?
insertQuestionAndHelpImagePath=INSERT INTO ckschema.checklist_help_text_details(bftm_attrib_id, bfs_form_lang_id, helptext_desc, image_url, help_text_level, association_id, created_by, created_date) VALUES (19, (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?), ?, ?, ?, ?, ?, now())
insertAnswerImagePath=INSERT INTO ckschema.checklist_record_image_data(record_id, image_location, image_desc, bfs_qa_assoc_id, image_type, image_thumbnail_data, element_id, sequesnce_no, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, now())
#updateAnswerImagePath=update ckschema.checklist_record_image_data set image_location = ?, image_thumbnail_data = ?, updated_by = ?, updated_date = now() where bfs_qa_assoc_id = ? and record_id = ?
updateAnswerImagePath=update ckschema.checklist_record_image_data set image_location = ?, image_thumbnail_data = ?, updated_by = ?, updated_date = now() where form_img_id = ? and bfs_qa_assoc_id = ? and record_id = ?
updateImagePathInBulk=update ckschema.checklist_record_image_data set image_location = ?, image_desc = ?, image_type = ?, updated_by = ?, updated_date = now() where bfs_qa_assoc_id = ? and record_id = ? and element_id = ? and sequesnce_no = ?
updateQuestionAndHelpImagePath=update ckschema.checklist_help_text_details set image_url = ?, updated_by = ?, updated_date = now() where association_id = ? and bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?)
deleteAnswerImagePath = delete from ckschema.checklist_record_image_data where form_img_id = ?
deleteQuestionAndHelpImagePath=delete from ckschema.checklist_help_text_details where image_url = ?
qaassocid=select bfs_qa_assoc_id from ckschema.checklist_ques_ans_mapping where bfs_ques_id = ?::integer;
#insertImagePathByPortal=INSERT INTO ckschema.checklist_temp_image_details(bfs_form_lang_id, bfs_section_id, bfs_step_id, bfs_question_id, image_desc, image_url, help_text_level, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, now())
insertImagePathByPortal=INSERT INTO ckschema.checklist_help_text_details(bfs_form_lang_id, helptext_desc, image_url, help_text_level, association_id, created_by, created_date) VALUES ((select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?), ?, ?, ?, ?, ?, now())
insertAnswerRuleImagePath=INSERT INTO ckschema.checklist_record_image_data(record_id, image_location, image_desc, bfs_qa_assoc_id, image_type, image_thumbnail_data, element_id, sequesnce_no, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, now())
updateAnswerRuleImagePath=update ckschema.checklist_record_image_data set image_location = ?, image_thumbnail_data = ?, element_id = ?, sequesnce_no = ?, updated_by = ?, updated_date = now() where bfs_qa_assoc_id = ? and record_id = ?
getChecklistRecordCount=select count(entry.record_id) from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id in (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id in (select bfd_form_id from ckschema.checklist_form_details where base_form_id = ?) and bfrm_language_name = ?) and entry.project_id = ?
getSingleRecordDetail=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name, entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no from ckschema.checklist_record_form_entry entry where entry.record_id = ?
insertAnswerThumbnailImage=INSERT INTO ckschema.checklist_record_image_data(record_id, bfs_qa_assoc_id, image_thumbnail_data, element_id, sequesnce_no, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, now())
deleteAnswerThumbnailImage=DELETE from ckschema.checklist_record_image_data where bfs_qa_assoc_id = ? and record_id = ?
getChecklistLatestVersion=SELECT max(publish_version) publish_version, bfd_form_id from ckschema.checklist_form_details where base_form_id = ? group by bfd_form_id order by publish_version;
getGroupIdsBySSOId=SELECT bi_group_id FROM ckschema.checklist_user_group_association WHERE user_id = (SELECT bi_user_id FROM ckschema.checklist_user_master WHERE bi_user_sso = ?)
getChecklistRecordSyncHistory=select catr.record_id,catr.record_version_no,catr.action,to_char(catr.sync_start_time, 'DD Mon YYYY HH12:MI:SS AM')sync_start_time, to_char(catr.sync_end_time, 'DD Mon YYYY HH12:MI:SS AM')sync_end_time,catr.status, crfat.created_by, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = crfat.created_by) created_by_name, to_char(crfat.created_date, 'DD Mon YYYY HH12:MI:SS AM')created_date, crfat.syncstatus, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = crfat.project_id) project_name, turbine_id from ckschema.checklist_audit_trail_records catr, ckschema.checklist_record_form_audit_trial crfat where catr.audit_id = crfat.audit_id and catr.record_id = ? and catr.record_version_no = ? order by created_date;
getImageId=select max(form_img_id) from ckschema.checklist_record_image_data;
getHelpImageId=select max(help_text_id) from ckschema.checklist_help_text_details;
##############################QUERIES RELATED TO ADMIN PORTAL SERVICES#########################################
portaluserroleandpermission=select cum.bi_user_sso, cum.bi_user_fname, cum.bi_user_lname,crm.role_name, cum.isadminportaluser from ckschema.checklist_user_master cum, ckschema.checklist_role_master crm where cum.bi_user_sso = ? and crm.role_name = (select crm.role_name from ckschema.checklist_role_master crm inner join ckschema.checklist_user_role_map curm on cum.bi_user_id = curm.user_id and crm.bi_role_id = curm.role_id);
checklistcomponent=select bftm_element_id, bftm_element_name, bftm_element_type, bftm_element_default_value, bftm_icon_name, bftm_icon_base64 from ckschema.checklist_element_master where is_active = 't'
loadchecklist=select cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbm.bi_business_name, cfd.created_date, cfsm.form_status, cfd.draft_version, cfd.publish_version
loadchecklist1=from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_version_master cvm, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cfd.created_by = cum.bi_user_sso::integer and cfd.created_by = cum.bi_user_sso::integer and cum.bi_user_id = cuga.user_id and cvm.bfd_id = cfd.bfd_form_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
pagechecklist=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, cfd.created_date,to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status, cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id =  lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
function=select bi_bus_group_name, bi_group_id FROM ckschema.checklist_bus_group_master where bi_bus_group_parent_id = ?::integer
subfunction=select bi_bus_group_name, bi_group_id FROM ckschema.checklist_bus_group_master where bi_bus_group_parent_id = ?::integer
subfunction_1=select bi_bus_group_name, bi_group_id FROM ckschema.checklist_bus_group_master where bi_bus_group_parent_id = ?::integer and bi_group_id in (select cbgm.bi_group_id from ckschema.checklist_bus_group_master cbgm where cbgm.bi_group_id in (select cbgm.bi_bus_group_parent_id from ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_master cum, ckschema.checklist_user_group_association cuga where cum.bi_user_sso = ? and cum.bi_user_id = cuga.user_id and  cuga.bi_group_id = cbgm.bi_group_id))
group=select bi_bus_group_name, bi_group_id FROM ckschema.checklist_bus_group_master where bi_bus_group_parent_id = ?::integer
ChecklistName=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, cfd.created_date, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id and upper(cfd.bfd_name) LIKE upper(?) order by cfd.created_date Desc;
Language=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, cfd.created_date, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and upper(lm.bfrm_language_name) LIKE upper(?) and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
Author=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, cfd.created_date, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and upper((select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by)) LIKE upper(?) and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
Function=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, cfd.created_date, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso =? and crm.role_name = ? and upper(cbgm.bi_bus_group_name) LIKE upper(?) and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
Version=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, cfd.created_date, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version  from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso =?  and crm.role_name =? and cfd.draft_version like ? and cfd.bfd_status_id=11 and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
Version_1=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, cfd.created_date, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso =?  and crm.role_name =? and cfd.publish_version=?::decimal and cfd.bfd_status_id=14 and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
Status=select distinct cfd.bfd_form_id, cfd.bfd_name, lm.bfrm_language_name, cfd.created_date, (select  bi_user_lname||','||bi_user_fname from ckschema.checklist_user_master where bi_user_sso=cfd.created_by) AS author_name, cbgm.bi_bus_group_name, to_char(cfd.created_date, 'DD Mon,YYYY') AS created_date, cfsm.form_status,cfd.draft_version, cfd.publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and upper(cfsm.form_status) LIKE upper(?) and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id = lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id order by cfd.created_date Desc;
deletechecklist=delete from ckschema.checklist_form_details where bfd_form_id = ?::integer and bfd_status_id = 11;
#delete from ckschema.checklist_form_details where bfd_form_id = ?::integer
getfunction=select cbgm.bi_group_id, cbgm.bi_bus_group_name, cbgm.bi_bus_group_parent_id from ckschema.checklist_bus_group_master cbgm where cbgm.bi_group_id in (select cbgm.bi_bus_group_parent_id from ckschema.checklist_bus_group_master cbgm where cbgm.bi_group_id in (select cbgm.bi_bus_group_parent_id from ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_master cum, ckschema.checklist_user_group_association cuga where cum.bi_user_sso = ? and cum.bi_user_id = cuga.user_id and  cuga.bi_group_id = cbgm.bi_group_id));
getelementproperties=select bftm_attrib_id,bftm_attrib_name,is_active, bftm_attrib_is_mandatory, bftm_attrib_def_value from ckschema.checklist_elem_attrib_master where bftm_element_id = ?
gettagelementvalues=select tag_master_id,tag_name from ckschema.checklist_tag_master;
saveformdetails=INSERT INTO ckschema.checklist_form_details(bfd_form_id,bfd_name,bfd_status_id,bfd_comments,isformconfigured,created_by,created_date,bfd_footer_detail,bfd_header_detail)VALUES (?,?,?,?,?,?,?,?,?);
formid=select nextval('checklist_chk_det_seq'::regclass);
savegroupassociation=INSERT INTO ckschema.checklist_group_association(group_id,bfd_form_id,is_active,created_by,created_date) VALUES(?,?,?,?,?);
savelanguagemap=INSERT INTO ckschema.checklist_language_map(bfd_form_id,bfrm_language_id,bfrm_language_name,is_active,created_by,created_date)VALUES(?,?,?,?,?,?);
saveformversion=INSERT INTO ckschema.checklist_version_master(version_no,bfd_id,created_by,created_date)VALUES(?,?,?,?);
sectionidquery=select nextval('checklist_section_id_seq'::regclass);
savesectiondetails=INSERT INTO ckschema.checklist_section_details(bfs_section_id,bfs_section_name,bfs_section_label,bfs_form_lang_id,bfs_is_out_of_scope_section,bfs_is_punchlist_section,section_order,created_by,created_date)VALUES(?,?,?,?,?,?,?,?,?);
stepidquery=select nextval('checklist_step_id_seq'::regclass);
savestepdetails=INSERT INTO ckschema.checklist_steps_details(bfs_step_id,bfs_step_name,bfs_step_label,bfs_section_id,step_order,created_by,created_date)VALUES(?,?,?,?,?,?,?);
answeridquery=select nextval('checklist_ans_id_seq'::regclass);
questionidquery=select nextval('checklist_ques_id_seq'::regclass);
savequestiondetails=INSERT INTO  ckschema.checklist_question_details(bfs_ques_id,ques_accessibility,bfs_is_punchlist_question,question_order,bfs_step_id,created_by,created_date,ques_desc,help_text)VALUES(?,?,?,?,?,?,?,?,?);
saveanswerdetails=INSERT INTO ckschema.checklist_answer_details(bfs_ans_id,ans_desc,created_by,created_date)VALUES(?,?,?,?);
quesanswermap=INSERT INTO ckschema.checklist_ques_ans_mapping(bfs_ques_id,bfs_ans_id,created_by,created_date)VALUES(?,?,?,?);
questionelemap=INSERT INTO ckschema.checklist_question_ele_map(bftm_element_id,bfs_ques_id,element_order,created_by,created_date)VALUES(?,?,?,?,?);
answerelemap=INSERT INTO ckschema.checklist_ans_ele_map(bftm_element_id,bfs_ans_id,element_order,created_by,created_date)VALUES(?,?,?,?,?);
saveelementattributemap=INSERT INTO ckschema.checklist_elem_attrib_mapping(bfs_element_id,bftm_attrib_id,bftm_attrib_value,qa_assoc_id,created_by,created_date)VALUES(?,?,?,?,?,?);
getquesassocid=select bfs_qa_assoc_id from ckschema.checklist_ques_ans_mapping where bfs_ques_id = ? and bfs_ans_id = ?;
#select nextval('checklist_ques_ans_id_seq'::regclass);
saverule=INSERT INTO ckschema.checklist_ans_rule_mapping(bfs_ans_rule_id,bfs_rule_id,bfs_ans_id,created_by,created_date,rule_formula_data)VALUES(?,?,?,?,?,?);
saveaction=INSERT INTO ckschema.checklist_ans_rule_action_mapping(ans_rule_map_id,rule_action_id,rule_action_output,rule_action_output_value,no_fields_to_add,is_active,created_by,created_date)VALUES(?,?,?,?,?,?,?,?);
getansrulemapid=select nextval('checklist_ans_rule_id_seq'::regclass);
savetagmap=INSERT INTO ckschema.checklist_tag_mapping(tag_master_id,qa_assoc_id,is_active,created_by,created_date)VALUES(?,?,?,?,?);
saveimage=INSERT INTO ckschema.checklist_help_text_details(bfs_form_lang_id,helptext_desc,image_url,help_text_level,created_by,created_date)VALUES(?,?,?,?,?,?);
getlanguage=Select bfrm_language_id from ckschema.checklist_language_master where upper(bfrm_language_name) = upper(?);
getanswerid=select bfs_ans_id from ckschema.checklist_answer_details where bfs_ans_id = ?;
ansmapid=select bfs_ans_ele_map_id from ckschema.checklist_ans_ele_map where bfs_ans_id = ? and bftm_element_id = ? and element_order = ?;
qesmapid=select bfs_ques_ele_map_id from ckschema.checklist_question_ele_map where bfs_ques_id = ?;
getsectionlist=select bfs_section_id, bfs_section_name from ckschema.checklist_section_details where bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id = ?);
getsteplist=select bfs_step_id, bfs_step_name from ckschema.checklist_steps_details where bfs_section_id = ?;
getquestionlist=select bfs_ques_id, ques_desc from ckschema.checklist_question_details where bfs_step_id = ?;
getFormTempImagePath=select image_desc, image_url, help_text_level from ckschema.checklist_temp_image_details where bfs_form_lang_id = ? and help_text_level = ?
getSectionTempImagePath=select image_desc, image_url, help_text_level from ckschema.checklist_temp_image_details where bfs_form_lang_id = ? and bfs_section_id = ? and help_text_level = ?
getStepTempImagePath=select image_desc, image_url, help_text_level from ckschema.checklist_temp_image_details where bfs_form_lang_id = ? and bfs_section_id = ? and bfs_step_id = ? and help_text_level = ?
getQuestionTempImagePath=select image_desc, image_url, help_text_level from ckschema.checklist_temp_image_details where bfs_form_lang_id = ? and bfs_section_id = ? and bfs_step_id = ? and bfs_question_id = ?
insertmetadataimages=INSERT INTO ckschema.checklist_help_text_details(bftm_attrib_id, bfs_form_lang_id, helptext_desc, image_url, help_text_level, association_id, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, ?, now())
removeTempImagePath=DELETE from ckschema.checklist_temp_image_details where created_by=?;
getChecklistDetailfromId=select form.bfd_form_id, form.bfd_name, (SELECT array_agg(helptext_details.*) FROM (select concat(helpdetail.help_text_id::text, '#'), concat(helpdetail.helptext_desc::text, '#'), concat(helpdetail.image_url::text, '#') from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = form.bfd_form_id and helpdetail.help_text_level = 'Form') helptext_details) form_helptext, (select count(sec.bfs_section_id) from ckschema.checklist_section_details sec, ckschema.checklist_language_map lanmap where sec.bfs_form_lang_id = lanmap.bfd_lang_id and lanmap.bfd_form_id = form.bfd_form_id) section_count, (select form_status from ckschema.checklist_form_status_master where form_status_id = bfd_status_id) form_status,(select bi_bus_group_name from ckschema.checklist_bus_group_master where bi_group_id = (select group_id from ckschema.checklist_group_association where bfd_form_id = form.bfd_form_id)) group_name, (select bi_bus_group_name from ckschema.checklist_bus_group_master where bi_group_id = (select bi_bus_group_parent_id from ckschema.checklist_bus_group_master where bi_group_id = (select group_id from ckschema.checklist_group_association where bfd_form_id = form.bfd_form_id))) sub_function_name, (select bi_bus_group_name from ckschema.checklist_bus_group_master where bi_group_id = (select bi_bus_group_parent_id from ckschema.checklist_bus_group_master where bi_group_id = (select bi_bus_group_parent_id from ckschema.checklist_bus_group_master where bi_group_id = (select group_id from ckschema.checklist_group_association where bfd_form_id = form.bfd_form_id)))) function_name,publish_version,draft_version,base_form_id, (select group_id from ckschema.checklist_group_association where bfd_form_id = form.bfd_form_id), form.project_applicability from ckschema.checklist_form_details form where form.bfd_form_id = ?
getChecklistMetadataDetail=SELECT sec.bfs_section_id, sec.bfs_section_label,bfs_section_name, (SELECT array_agg(helptext_details.*) FROM (select concat(helpdetail.help_text_id::text, '#'), concat(helpdetail.helptext_desc::text, '#'), concat(helpdetail.image_url::text, '#') from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id  = sec.bfs_section_id and helpdetail.help_text_level = 'Section') helptext_details) section_helptext, (SELECT array_agg(sq.*) FROM (SELECT step.bfs_step_id,bfs_step_name, (SELECT array_agg(help_image.*) FROM (SELECT concat(helpdetail.help_text_id::text, '#')|| concat(helpdetail.helptext_desc::text, '#')|| helpdetail.image_url from ckschema.checklist_help_text_details helpdetail where helpdetail.association_id = step.bfs_step_id and help_text_level = 'Step')help_image) stephelpdetail FROM ckschema.checklist_steps_details step WHERE step.bfs_section_id = sec.bfs_section_id) sq) step_detail FROM ckschema.checklist_section_details sec WHERE sec.bfs_form_lang_id in (select bfd_lang_id from ckschema.checklist_language_map lanmap, ckschema.checklist_form_details form where lanmap.bfd_form_id = form.bfd_form_id and form.bfd_form_id = ?) ORDER BY sec.section_order asc;
#######################################################################Queries for Delete checklist#######################################################################
getImagePathforDelete=SELECT image_url from ckschema.checklist_help_text_details where bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id =? and upper(bfrm_language_name) = upper(?))
deleteChecklistMetadata=SELECT ckschema.delete_checklist_proc(?,?)
#############################Checklist Publishment###########################
checklistpublish=update ckschema.checklist_form_details set bfd_status_id=14 where bfd_form_id=?::integer
################################################Audit Trail######################################################
checklistaudittrail=INSERT INTO ckschema.checklist_meta_data_audit_trial(checklist_id, comments, status, json_data, created_by, created_date, action, draft_version, publish_version) VALUES (?::integer, ?, ?, ?,?, ?::timestamp, ?, ?, ?::decimal)
insertrecordaudit=INSERT INTO ckschema.checklist_audit_trail_records(audit_id, record_id, sync_start_time, sync_end_time, error_log, status, created_by, created_date, record_version_no, action, form_lang_id) VALUES (?::integer, ?::integer, ?::timestamp, ?::timestamp, ?, ?, ?, ?::timestamp, ?::decimal, ?, ?::integer)
insertrecordformaudit=INSERT INTO ckschema.checklist_record_form_audit_trial(record_id, audit_id, created_by, created_date, syncstatus, project_id, turbine_id, status_id, comments) VALUES (?::integer, ?::integer, ?, ?::timestamp, ?, ?, ?, (select form_status_id from ckschema.checklist_form_status_master where upper(form_status) = upper(?)), ?);
insertrecordrulesaudit=INSERT INTO ckschema.checklist_rules_answers_audit_trial(record_ans_id, record_id, audit_id, created_by, created_date, bfs_qa_assoc_id, ans_desc, ans_key)VALUES (?::integer, ?::integer, ?::integer, ?, ?::timestamp, ?::integer, ?, ?);
insertrecordsectionaudit=INSERT INTO ckschema.checklist_record_section_step_det_audit_trial(record_detail_id, record_id, audit_id, created_by, created_date, section_id, step_id, bfs_qa_assoc_id, ans_desc, sync_status, comments, is_deleted, element_id, sequence_no, is_punchlist) VALUES (?::integer, ?::integer, ?::integer, ?, ?::timestamp, ?::integer, ?, ?::integer, ?, ?, ?, ?, ?::integer, ?::integer, ?);
auditidquery=select nextval('ckschema.checklist_audit_records_seq'::regclass);
recordsectionstepid=select max(record_detail_id) from ckschema.checklist_record_section_step_details;
insertrecordimageaudit=INSERT INTO ckschema.checklist_record_image_audit_trail(record_image_id, record_id, audit_id, created_by, created_date, bfs_qa_assoc_id, element_id, image_location, image_desc, image_type, sequence_no, image_thumbnail_data) VALUES (?::integer, ?::integer, ?::integer, ?, ?::timestamp, ?::integer, ?::integer, ?, ?, ?, ?::integer, ?)
selectRuleAnsId=select record_ans_id from ckschema.checklist_rules_answers_audit_trial where bfs_qa_assoc_id=?::integer and record_id=?::integer and created_by=?;
############################Record Management Search#####################################################################################
selectpublishversion=select distinct publish_version from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_version_master cvm, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id =  lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id and bfd_name=? and cfd.bfd_status_id=14
selectchecklistname=select distinct cfd.bfd_name as formname from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_version_master cvm, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name = ? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id =  lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id and cfd.bfd_status_id=14;
recordsearchquery=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name,entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no, (SELECT array_agg(sec_detail.*) FROM (select distinct concat(secdetail.section_id::text),concat((select mar.bfs_section_name from ckschema.checklist_section_details mar where mar.bfs_section_id=secdetail.section_id)),concat(secdetail.step_id::text),concat((select bfs_step_name from ckschema.checklist_steps_details where bfs_step_id=secdetail.step_id)::text),concat(secdetail.ans_desc::text) ,concat(quedetail.bfs_ques_id::text),concat((select ques_desc from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text), concat((select question_order from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text), concat(mapp.bfs_ans_id::text),concat(secdetail.comments::text, '~'),concat((select eamap.bftm_attrib_value from ckschema.checklist_elem_attrib_mapping eamap where eamap.bftm_attrib_value='comments' and eamap.bftm_attrib_id = (select bftm_attrib_id from ckschema.checklist_elem_attrib_master where (bftm_attrib_name = 'name' or bftm_attrib_name = 'Name') and bftm_element_id = secdetail.element_id) and eamap.qa_assoc_id = (select bfs_ans_ele_map_id from ckschema.checklist_ans_ele_map aemap where aemap.bfs_ans_id = mapp.bfs_ans_id and aemap.bftm_element_id = secdetail.element_id and aemap.element_order = secdetail.sequesnce_no))::text, '#') from ckschema.checklist_record_section_step_details secdetail,ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and quedetail.bfs_step_id = secdetail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id ) sec_detail) sec_details from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp
recordformid=select bfd_form_id from ckschema.checklist_form_details where bfd_name=? and publish_version=?::decimal
recordformid_1=select bfd_form_id from ckschema.checklist_form_details where bfd_name=? and draft_version=?
recordsectiondetails=select (SELECT array_agg(sec_detail.*) FROM (select distinct concat(csd.bfs_section_id::text,'#'),concat(csd.bfs_section_name::text,'#'), concat(csdd.bfs_step_id::text, '#'), concat(csdd.bfs_step_name::text,'#'))sec_detail) from ckschema.checklist_form_details cfd, ckschema.checklist_section_details csd, ckschema.checklist_steps_details csdd, ckschema.checklist_language_map lm where cfd.bfd_form_id=?::integer and lm.bfd_form_id=cfd.bfd_form_id and csd.bfs_form_lang_id=lm.bfd_lang_id and csdd.bfs_section_id=csd.bfs_section_id
recordsearchquery_1=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name,entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no, (SELECT array_agg(sec_detail.*) FROM (select distinct concat(secdetail.section_id::text,'#'),concat((select mar.bfs_section_name from ckschema.checklist_section_details mar where mar.bfs_section_id=secdetail.section_id), '#'),concat(secdetail.step_id::text,'#'),concat((select bfs_step_name from ckschema.checklist_steps_details where bfs_step_id=secdetail.step_id)::text, '#'),concat(secdetail.ans_desc::text, '#') ,concat(quedetail.bfs_ques_id::text,'#'),concat((select ques_desc from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text,'#'), concat((select question_order from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text,'#'), concat(mapp.bfs_ans_id::text,'#'),concat(secdetail.comments::text, '#') from ckschema.checklist_record_section_step_details secdetail,ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and quedetail.bfs_step_id = secdetail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id AND secdetail.step_id=?::integer AND secdetail.section_id=?::integer) sec_detail) sec_details from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp
recordsearchquery_2=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name,entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no, (SELECT array_agg(sec_detail.*) FROM (select distinct concat(secdetail.section_id::text,'#'),concat((select mar.bfs_section_name from ckschema.checklist_section_details mar where mar.bfs_section_id=secdetail.section_id), '#'),concat(secdetail.step_id::text,'#'),concat((select bfs_step_name from ckschema.checklist_steps_details where bfs_step_id=secdetail.step_id)::text, '#'),concat(secdetail.ans_desc::text, '#') ,concat(quedetail.bfs_ques_id::text,'#'),concat((select ques_desc from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text,'#'), concat((select question_order from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text,'#'), concat(mapp.bfs_ans_id::text,'#'),concat(secdetail.comments::text, '#') from ckschema.checklist_record_section_step_details secdetail,ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and quedetail.bfs_step_id = secdetail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id AND secdetail.section_id=?::integer) sec_detail) sec_details from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp
selectProjectNames=select distinct sys_project_id, project_id, project_name from ckschema.checklist_edsr_proj_turb_details WHERE visible = 'Yes' order by project_name;
recordsearchquery_3=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name,entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no, (SELECT array_agg(sec_detail.*) FROM (select distinct concat(secdetail.section_id::text),concat((select mar.bfs_section_name from ckschema.checklist_section_details mar where mar.bfs_section_id=secdetail.section_id)),concat(secdetail.step_id::text),concat((select bfs_step_name from ckschema.checklist_steps_details where bfs_step_id=secdetail.step_id)::text),concat(secdetail.ans_desc::text) ,concat(quedetail.bfs_ques_id::text),concat((select ques_desc from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text), concat((select question_order from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id)::text), concat(mapp.bfs_ans_id::text),concat(secdetail.comments::text) from ckschema.checklist_record_section_step_details secdetail,ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and quedetail.bfs_step_id = secdetail.step_id and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id ) sec_detail) sec_details from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp and entry.project_id=?
recordprojectapplicability=select distinct project_applicability from ckschema.checklist_form_details where bfd_name=?
recordsections=select distinct entry.record_id, secdetail.section_id,  (select mar.bfs_section_name from ckschema.checklist_section_details mar where mar.bfs_section_id=secdetail.section_id) from ckschema.checklist_record_section_step_details secdetail, ckschema.checklist_record_form_entry entry where secdetail.record_id  = entry.record_id and entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp order by secdetail.section_id;
recordsteps=select distinct secdetail.section_id, secdetail.step_id, (select bfs_step_name from ckschema.checklist_steps_details where bfs_step_id=secdetail.step_id) from ckschema.checklist_record_section_step_details secdetail, ckschema.checklist_record_form_entry entry where secdetail.record_id  = entry.record_id and entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and updated_date::date >= ?::timestamp AND updated_date::date <= ?::timestamp order by secdetail.section_id, secdetail.step_id;
recordques=select distinct secdetail.step_id, quedetail.bfs_ques_id, (select ques_desc from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id),mapp.bfs_ans_id,secdetail.comments, (select question_order from ckschema.checklist_question_details where bfs_ques_id=quedetail.bfs_ques_id) from ckschema.checklist_record_section_step_details secdetail, ckschema.checklist_record_form_entry entry, ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id and entry.updated_date::date >= ?::timestamp AND entry.updated_date::date <= ?::timestamp order by quedetail.bfs_ques_id;
records=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name, entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and entry.updated_date::date >= ?::timestamp AND entry.updated_date::date <= ?::timestamp order by entry.record_id;
records_1=select distinct entry.record_id, entry.syncstatus, (select form_status from ckschema.checklist_form_status_master where form_status_id = entry.form_status_id)recordstatus, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.created_by) created_by_name, (select bi_user_fname ||' '|| bi_user_lname from ckschema.checklist_user_master where bi_user_sso = entry.updated_by) modifiedby_name, entry.updated_by, entry.created_by, entry.updated_date, entry.created_date, entry.project_id, entry.turbine_id, (select distinct project_name from ckschema.checklist_edsr_proj_turb_details where project_id = entry.project_id) project_name, entry.record_version_no from ckschema.checklist_record_form_entry entry where entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and entry.updated_date::date >= ?::timestamp AND entry.updated_date::date <= ?::timestamp and entry.project_id=? order by entry.record_id;
recordcomments=select entry.record_id,quedetail.bfs_ques_id,mapp.bfs_ans_id,secdetail.ans_desc,secdetail.comments,(select eamap.bftm_attrib_value from ckschema.checklist_elem_attrib_mapping eamap where eamap.bftm_attrib_id = (select bftm_attrib_id from ckschema.checklist_elem_attrib_master where (bftm_attrib_name = 'name' or bftm_attrib_name = 'Name') and bftm_element_id = secdetail.element_id) and eamap.qa_assoc_id = (select bfs_ans_ele_map_id from ckschema.checklist_ans_ele_map aemap where aemap.bfs_ans_id = mapp.bfs_ans_id and aemap.bftm_element_id = secdetail.element_id and aemap.element_order = secdetail.sequesnce_no)) from ckschema.checklist_record_section_step_details secdetail, ckschema.checklist_record_form_entry entry, ckschema.checklist_question_details quedetail, ckschema.checklist_ques_ans_mapping mapp where secdetail.record_id  = entry.record_id and entry.bfs_form_lang_id = (select bfd_lang_id from ckschema.checklist_language_map where bfd_form_id::integer = ?::integer and bfrm_language_name = ?) and mapp.bfs_ques_id = quedetail.bfs_ques_id and secdetail.bfs_qa_assoc_id =  mapp.bfs_qa_assoc_id and entry.updated_date::date >= ?::timestamp AND entry.updated_date::date <= ?::timestamp order by quedetail.bfs_ques_id;
##############################Version Checking###################################################################################
checkformforedit=select count(*) from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name =? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id =  lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id and cfd.bfd_name=? and cfd.base_form_id is null and cfd.bfd_status_id=11;
checkformforedit_1=select distinct cfd.bfd_form_id, cfd.bfd_name,cfsm.form_status, cfd.draft_version, cfd.publish_version , cfd.base_form_id from ckschema.checklist_form_details cfd, ckschema.checklist_language_master lm, ckschema.checklist_user_master cum, ckschema.checklist_bus_group_master cbgm, ckschema.checklist_user_group_association cuga, ckschema.checklist_group_association cga, ckschema.checklist_form_status_master cfsm, ckschema.checklist_language_map clm, ckschema.checklist_role_master crm, ckschema.checklist_user_role_map curm where cum.bi_user_sso = ? and crm.role_name =? and curm.user_id = cum.bi_user_id and curm.role_id = crm.bi_role_id and cfd.bfd_form_id = clm.bfd_form_id and clm.bfrm_language_id =  lm.bfrm_language_id and cum.bi_user_id = cuga.user_id and cfd.bfd_status_id = cfsm.form_status_id and cga.bfd_form_id=cfd.bfd_form_id and cga.group_id=cbgm.bi_group_id and cfd.bfd_name=? and cfd.base_form_id is not null order by bfd_form_id;
##############################Help Images New Approach###################################################################################
inserthelpimage=INSERT INTO ckschema.checklist_help_image_details(bfs_form_lang_id, association_id, help_img_url, help_text_level, help_img_thumbnail, created_by, created_date) VALUES (?, ?, ?, ?, ?, ?, now());
inserthelpimagedescription=INSERT INTO ckschema.checklist_help_text_details_1(bfs_form_lang_id, help_desc, help_text_level, association_id, created_by, created_date) VALUES(?, ?, ?, ?, ?, now());
################################Enter Exit#############################################################################################################################################################################################################################################################################
turbinetenjobs=SELECT * FROM ckschema.xxxxx where status="close" and date=sysdate-10;
createjob=INSERT INTO ckschema.xxxx values(?,?,?,?,?,?,?,?,?,?,?,?,?);